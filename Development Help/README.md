# Photopharmics Android App (`photopharmics-new-android`)

This repository contains the Android version of the Photopharmics mobile application, built using React Native. Development is conducted via Android Studio, with manual builds and Expo used for production deployment.

---

## Prerequisites

Ensure the following tools are installed:

- [GitHub Desktop](https://desktop.github.com/)
- [Node.js (LTS)](https://nodejs.org/)
- npm (comes with Node.js)
- [Android Studio](https://developer.android.com/studio)
- [Java Development Kit (JDK 17+)](https://www.oracle.com/java/technologies/javase/jdk17-archive-downloads.html)
- Expo CLI  
  ```bash
  npm install -g expo-cli
  ```
- EAS CLI  
  ```bash
  npm install -g eas-cli
  ```
- ADB (Android Debug Bridge)

---

## Project Setup

### 1. Clone the Repository Using GitHub Desktop

1. Open GitHub Desktop  
2. Go to **File > Clone Repository**  
3. In the **GitHub.com** tab, search for `photopharmics-new-android`  
4. Choose the local path for the clone  
5. Click **Clone**  

### 2. Install Dependencies

In your terminal (inside the root project directory):

```bash
npm install
```

### 3. Open the Project

- Use **Visual Studio Code** for editing  
- Open the project in **Android Studio** by selecting the `android/` folder  

---

## Running the App in Development

### Option 1: Using an Android Emulator

1. Open **Android Studio > Tools > Device Manager**  
2. Start your virtual device  
3. In the project root, start the Metro bundler (can easily be done through the built-in terminal in Android Studio):

```bash
npx react-native start
```

4. The app should auto-launch once the emulator is ready

### Option 2: Using a Physical Android Device

1. Connect your phone via USB with **USB Debugging** enabled  
2. In Android Studio terminal, confirm connection:

```bash
adb devices
```

3. Start the Metro bundler:

```bash
npx react-native start
```

4. Port forward the Metro bundler:

```bash
adb reverse tcp:8081 tcp:8081
```

5. The app should launch automatically on your phone (If not you can try to click on 'r' key to reset project in the terminal)

---

## Building and Deploying the App

### 1. Update the App Version

Update the version in the following files:

- `app.json`

```json
{
  "expo": {
    "version": "1.0.1",
    "android": {
      "versionCode": 2
    }
  }
}
```

- `android/app/build.gradle`

```gradle
android {
  defaultConfig {
    versionCode 2
    versionName "1.0.1"
  }
}
```

### 2. Configure EAS Build

If this is your first build or you're setting up a new system:

```bash
eas build:configure
```

Choose **Android** when prompted.

### 3. Build with EAS

To generate a Play Storeâ€“ready `.aab` file:

```bash
eas build --platform android --profile release
```

Your `eas.json` should look like this:

```json
{
  "build": {
    "release": {
      "releaseChannel": "prod",
      "distribution": "store",
      "env": {
        "CELESTE_API_URL": "https://api.photopharmics-celeste.com",
        "COGNITO_USER_POOL": "us-west-2_BPQyb0Lce",
        "COGNITO_WEB_CLIENT": "74f3voihvifsacftl0rcu926lp"
      }
    },
    "development": {
      "releaseChannel": "dev",
      "distribution": "internal",
      "developmentClient": true,
      "env": {
        "CELESTE_API_URL": "https://develop.api.photopharmics-celeste.com",
        "COGNITO_USER_POOL": "us-west-2_yt66fTDXo",
        "COGNITO_WEB_CLIENT": "htda39b6u6evgsv67pepvc53e"
      }
    }
  },
  "cli": {
    "version": ">= 0.47.0"
  }
}
```

---

## Submitting to Google Play Store

1. Visit [Google Play Console](https://play.google.com/console)  
2. Select your app > **Release > Production > Create new release**  
3. Upload the `.aab` file generated by EAS  
4. Enter version info and release notes  
5. Click **Start rollout to production**

---
